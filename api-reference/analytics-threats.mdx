---
title: 'GET /analytics/threats'
api: 'GET https://api.vouch.expert/analytics/threats'
description: 'Get threat intelligence and fraud detection analytics'
---

## Overview

The `/analytics/threats` endpoint provides insights into detected threats, fraud attempts, and validation recommendations. Monitor blocked emails, flagged IPs, and security events.

<Note>
  You can use either the versioned endpoint `/v1/analytics/threats` or the latest endpoint `/analytics/threats`
</Note>

## Authentication

<ParamField header="Authorization" type="string" required>
  Bearer token with your server API key

  ```
  Authorization: Bearer your_server_api_key_here
  ```
</ParamField>

<ParamField header="X-Project-Id" type="string" required>
  Your project ID

  ```
  X-Project-Id: your_project_id
  ```
</ParamField>

<Warning>
  This endpoint requires a **server API key**. Do not use client API keys for analytics endpoints.
</Warning>

## Query Parameters

<ParamField query="startDate" type="string">
  Start date in ISO 8601 format (defaults to 30 days ago)

  ```
  ?startDate=2024-01-01T00:00:00Z
  ```
</ParamField>

<ParamField query="endDate" type="string">
  End date in ISO 8601 format (defaults to now)

  ```
  ?endDate=2024-01-31T23:59:59Z
  ```
</ParamField>

<ParamField query="groupBy" type="string">
  Group results by time interval: `hour`, `day`, `week`, or `month` (defaults to `day`)

  ```
  ?groupBy=day
  ```
</ParamField>

<ParamField query="threatType" type="string">
  Filter by specific threat type: `disposable`, `invalid`, `fraud`, `abuse`, or `all` (defaults to `all`)

  ```
  ?threatType=fraud
  ```
</ParamField>

<ParamField query="recommendation" type="string">
  Filter by recommendation: `allow`, `flag`, or `block` (returns all if not specified)

  ```
  ?recommendation=block
  ```
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Whether the request was successful
</ResponseField>

<ResponseField name="data" type="object">
  Analytics data

  <Expandable title="properties">
    <ResponseField name="summary" type="object">
      Summary statistics for the time period

      <Expandable title="properties">
        <ResponseField name="totalValidations" type="number">
          Total number of email validations
        </ResponseField>

        <ResponseField name="blockedCount" type="number">
          Number of validations with "block" recommendation
        </ResponseField>

        <ResponseField name="flaggedCount" type="number">
          Number of validations with "flag" recommendation
        </ResponseField>

        <ResponseField name="allowedCount" type="number">
          Number of validations with "allow" recommendation
        </ResponseField>

        <ResponseField name="blockRate" type="number">
          Percentage of validations blocked (0-100)
        </ResponseField>

        <ResponseField name="flagRate" type="number">
          Percentage of validations flagged (0-100)
        </ResponseField>
      </Expandable>
    </ResponseField>

    <ResponseField name="threats" type="array">
      Threat type breakdown

      <Expandable title="properties">
        <ResponseField name="type" type="string">
          Threat type identifier
        </ResponseField>

        <ResponseField name="name" type="string">
          Human-readable threat name
        </ResponseField>

        <ResponseField name="count" type="number">
          Number of detections
        </ResponseField>

        <ResponseField name="percentage" type="number">
          Percentage of total threats
        </ResponseField>

        <ResponseField name="severity" type="string">
          Severity level: `low`, `medium`, `high`, or `critical`
        </ResponseField>
      </Expandable>
    </ResponseField>

    <ResponseField name="signals" type="array">
      Most common threat signals detected

      <Expandable title="properties">
        <ResponseField name="signal" type="string">
          Signal identifier
        </ResponseField>

        <ResponseField name="description" type="string">
          Human-readable description
        </ResponseField>

        <ResponseField name="count" type="number">
          Number of times detected
        </ResponseField>

        <ResponseField name="recommendation" type="string">
          Most common recommendation for this signal
        </ResponseField>
      </Expandable>
    </ResponseField>

    <ResponseField name="timeSeries" type="array">
      Time-series data grouped by the specified interval

      <Expandable title="properties">
        <ResponseField name="timestamp" type="string">
          ISO 8601 timestamp for the interval
        </ResponseField>

        <ResponseField name="total" type="number">
          Total validations in this interval
        </ResponseField>

        <ResponseField name="blocked" type="number">
          Blocked validations in this interval
        </ResponseField>

        <ResponseField name="flagged" type="number">
          Flagged validations in this interval
        </ResponseField>

        <ResponseField name="allowed" type="number">
          Allowed validations in this interval
        </ResponseField>
      </Expandable>
    </ResponseField>

    <ResponseField name="topIssues" type="array">
      Most frequently detected issues

      <Expandable title="properties">
        <ResponseField name="issue" type="string">
          Issue identifier
        </ResponseField>

        <ResponseField name="description" type="string">
          Human-readable description
        </ResponseField>

        <ResponseField name="count" type="number">
          Number of occurrences
        </ResponseField>

        <ResponseField name="examples" type="array">
          Example email addresses (anonymized)
        </ResponseField>
      </Expandable>
    </ResponseField>
  </Expandable>
</ResponseField>

## Example Request

<CodeGroup>
```bash cURL
curl -X GET "https://api.vouch.expert/analytics/threats?startDate=2024-01-01&endDate=2024-01-31&recommendation=block" \
  -H "Authorization: Bearer your_server_api_key" \
  -H "X-Project-Id: your_project_id"
```

```javascript JavaScript
const response = await fetch(
  'https://api.vouch.expert/analytics/threats?startDate=2024-01-01&endDate=2024-01-31&recommendation=block',
  {
    method: 'GET',
    headers: {
      'Authorization': 'Bearer your_server_api_key',
      'X-Project-Id': 'your_project_id',
    },
  }
);

const data = await response.json();
console.log(data);
```

```python Python
import requests

response = requests.get(
    'https://api.vouch.expert/analytics/threats',
    headers={
        'Authorization': 'Bearer your_server_api_key',
        'X-Project-Id': 'your_project_id',
    },
    params={
        'startDate': '2024-01-01',
        'endDate': '2024-01-31',
        'recommendation': 'block',
    }
)

data = response.json()
print(data)
```
</CodeGroup>

## Example Response

```json
{
  "success": true,
  "data": {
    "summary": {
      "totalValidations": 15420,
      "blockedCount": 892,
      "flaggedCount": 1234,
      "allowedCount": 13294,
      "blockRate": 5.8,
      "flagRate": 8.0
    },
    "threats": [
      {
        "type": "disposable_email",
        "name": "Disposable Email",
        "count": 456,
        "percentage": 51.1,
        "severity": "medium"
      },
      {
        "type": "invalid_mx",
        "name": "Invalid MX Records",
        "count": 234,
        "percentage": 26.2,
        "severity": "high"
      },
      {
        "type": "suspicious_ip",
        "name": "Suspicious IP Address",
        "count": 123,
        "percentage": 13.8,
        "severity": "high"
      },
      {
        "type": "role_email",
        "name": "Role-Based Email",
        "count": 79,
        "percentage": 8.9,
        "severity": "low"
      }
    ],
    "signals": [
      {
        "signal": "disposable_domain",
        "description": "Email from known disposable email provider",
        "count": 456,
        "recommendation": "block"
      },
      {
        "signal": "mx_missing",
        "description": "Domain has no MX records",
        "count": 234,
        "recommendation": "block"
      },
      {
        "signal": "ip_blacklisted",
        "description": "IP address on threat intelligence blacklist",
        "count": 123,
        "recommendation": "block"
      },
      {
        "signal": "role_address",
        "description": "Generic role-based email (info@, admin@, etc.)",
        "count": 79,
        "recommendation": "flag"
      }
    ],
    "timeSeries": [
      {
        "timestamp": "2024-01-01T00:00:00Z",
        "total": 523,
        "blocked": 31,
        "flagged": 42,
        "allowed": 450
      },
      {
        "timestamp": "2024-01-02T00:00:00Z",
        "total": 487,
        "blocked": 28,
        "flagged": 39,
        "allowed": 420
      }
    ],
    "topIssues": [
      {
        "issue": "disposable_tempmail",
        "description": "Tempmail.com disposable email addresses",
        "count": 156,
        "examples": [
          "u***@tempmail.com",
          "t***@tempmail.com",
          "a***@tempmail.com"
        ]
      },
      {
        "issue": "invalid_domain",
        "description": "Domain does not exist or has no mail server",
        "count": 98,
        "examples": [
          "user@nonexistent***",
          "test@invalid***",
          "fake@notreal***"
        ]
      },
      {
        "issue": "tor_exit_node",
        "description": "Request from Tor exit node",
        "count": 67,
        "examples": [
          "u***@gmail.com (via Tor)",
          "t***@yahoo.com (via Tor)"
        ]
      }
    ]
  }
}
```

## Use Cases

### 1. Security Dashboard

Monitor threat levels in real-time:

```javascript
const response = await fetch(
  'https://api.vouch.expert/analytics/threats',
  {
    headers: {
      'Authorization': 'Bearer your_server_api_key',
      'X-Project-Id': 'your_project_id',
    },
  }
);

const { data } = await response.json();

// Display key metrics
console.log(`Block Rate: ${data.summary.blockRate}%`);
console.log(`Flag Rate: ${data.summary.flagRate}%`);

// Alert if block rate is unusually high
if (data.summary.blockRate > 10) {
  sendAlert('High threat activity detected');
}
```

### 2. Threat Type Analysis

Identify most common attack vectors:

```javascript
const { data } = await response.json();

// Sort threats by count
const topThreats = data.threats
  .sort((a, b) => b.count - a.count)
  .slice(0, 5);

console.log('Top 5 threats:');
topThreats.forEach(threat => {
  console.log(`${threat.name}: ${threat.count} (${threat.severity})`);
});

// Focus security efforts on critical threats
const criticalThreats = data.threats.filter(t => t.severity === 'critical');
if (criticalThreats.length > 0) {
  console.warn('Critical threats detected:', criticalThreats);
}
```

### 3. Fraud Prevention

Detect patterns in fraudulent activity:

```javascript
const { data } = await response.json();

// Analyze time-series for suspicious patterns
const recentSpikes = data.timeSeries.filter(
  (entry, index, array) => {
    if (index === 0) return false;
    const previousEntry = array[index - 1];
    return entry.blocked > previousEntry.blocked * 2; // 2x increase
  }
);

if (recentSpikes.length > 0) {
  console.warn('Sudden spike in blocked emails detected');
  // Investigate and potentially tighten security
}
```

### 4. Issue Resolution Tracking

Monitor improvements over time:

```javascript
// Fetch data for current and previous periods
const current = await fetchThreats('2024-02-01', '2024-02-29');
const previous = await fetchThreats('2024-01-01', '2024-01-31');

// Compare block rates
const improvement = previous.summary.blockRate - current.summary.blockRate;

if (improvement > 0) {
  console.log(`✓ Block rate improved by ${improvement.toFixed(1)}%`);
} else {
  console.warn(`✗ Block rate increased by ${Math.abs(improvement).toFixed(1)}%`);
}
```

### 5. Custom Threat Rules

Use analytics to inform custom rules:

```javascript
const { data } = await response.json();

// Identify patterns worth adding custom rules for
const highVolumeLowSeverity = data.threats.filter(
  t => t.count > 100 && t.severity === 'low'
);

// Consider creating custom rules to auto-block these
highVolumeLowSeverity.forEach(threat => {
  console.log(`Consider custom rule for: ${threat.name}`);
});
```

## Threat Types Reference

| Type | Description | Typical Recommendation |
|------|-------------|----------------------|
| `disposable_email` | Known disposable email provider | Block |
| `invalid_mx` | Domain has no MX records | Block |
| `invalid_smtp` | SMTP verification failed | Block |
| `suspicious_ip` | IP on threat intelligence list | Block/Flag |
| `role_email` | Generic role-based email | Flag |
| `catch_all` | Domain accepts all emails | Flag |
| `syntax_error` | Invalid email format | Block |
| `alias_email` | Email alias service detected | Flag |
| `tor_exit` | Request from Tor network | Block/Flag |
| `vpn_detected` | Request from VPN | Flag |

## Error Responses

<ResponseExample>
```json 401 Unauthorized
{
  "success": false,
  "error": "Invalid API key or project ID",
  "code": "UNAUTHORIZED"
}
```

```json 400 Bad Request
{
  "success": false,
  "error": "Invalid threat type",
  "code": "INVALID_PARAMETERS"
}
```

```json 429 Rate Limit
{
  "success": false,
  "error": "Rate limit exceeded",
  "code": "RATE_LIMIT_EXCEEDED",
  "retryAfter": 60
}
```
</ResponseExample>

## Rate Limits

- **100 requests per minute** per project
- Rate limit headers included in response:
  - `X-RateLimit-Limit`: Maximum requests per window
  - `X-RateLimit-Remaining`: Remaining requests in current window
  - `X-RateLimit-Reset`: Unix timestamp when the window resets

## Best Practices

1. **Monitor Trends**: Set up automated alerts for unusual spikes in threats or changes in threat patterns.

2. **Regular Reviews**: Review threat analytics weekly to adjust your validation rules and security posture.

3. **Combine Signals**: Use multiple threat signals together for more accurate fraud detection.

4. **Investigate Anomalies**: When you see unusual patterns, investigate promptly to prevent larger security issues.

5. **Share Intelligence**: If you detect coordinated attacks, report them to support@vouch.expert to help protect the entire platform.

## Data Privacy

<Info>
  All email addresses in examples are anonymized with only partial information shown. Full email addresses are never exposed in analytics endpoints.
</Info>

## Threat Intelligence Sources

Vouch aggregates threat intelligence from multiple sources:
- Disposable email provider lists (updated daily)
- IP reputation databases (MaxMind, AbuseIPDB)
- Known fraud patterns and attack signatures
- Community-reported threats
- Historical validation data across all projects
